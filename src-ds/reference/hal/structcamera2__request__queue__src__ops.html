<!DOCTYPE html>
<html devsite>
<head>
  <title>Android Hardware Abstraction Layer: camera2_request_queue_src_ops Struct Reference</title>
  <meta name="project_path" value="/_project.yaml" />
  <meta name="book_path" value="/_book.yaml" />
  <meta name="hide_page_heading" value="true" />
</head>
<body>
  <div id="top"><!-- do not remove this div --></div>
  <h1><div class="title">camera2_request_queue_src_ops Struct Reference</div></h1>

<div id="doc-content">
<div class="header">
 <div class="summary">
  <a href="#pub-attribs">
   Data Fields
  </a>
 </div>
 <div class="headertitle">
  <div class="title">
   camera2_request_queue_src_ops Struct Reference
  </div>
 </div>
</div>
<!--header-->
<div class="contents">
 <p>
  <code>
   #include &lt;
   <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera2.h">
    camera2.h
   </a>
   &gt;
  </code>
 </p>
 <table class="memberdecls">
  <tr class="heading">
   <td colspan="2">
    <h2 class="groupheader">
     <a name="pub-attribs">
     </a>
     Data Fields
    </h2>
   </td>
  </tr>
  <tr class="memitem:a19ec09251038ee392fedcaeb68ede229">
   <td class="memItemLeft" align="right" valign="top">
    int(*&#160;
   </td>
   <td class="memItemRight" valign="bottom">
    <a class="el" href="structcamera2__request__queue__src__ops.html#a19ec09251038ee392fedcaeb68ede229">
     request_count
    </a>
    )(const struct
    <a class="el" href="structcamera2__request__queue__src__ops.html">
     camera2_request_queue_src_ops
    </a>
    *q)
   </td>
  </tr>
  <tr class="separator:a19ec09251038ee392fedcaeb68ede229">
   <td class="memSeparator" colspan="2">
    &#160;
   </td>
  </tr>
  <tr class="memitem:a79adee987dbd6a8ea0cfab81c89ae579">
   <td class="memItemLeft" align="right" valign="top">
    int(*&#160;
   </td>
   <td class="memItemRight" valign="bottom">
    <a class="el" href="structcamera2__request__queue__src__ops.html#a79adee987dbd6a8ea0cfab81c89ae579">
     dequeue_request
    </a>
    )(const struct
    <a class="el" href="structcamera2__request__queue__src__ops.html">
     camera2_request_queue_src_ops
    </a>
    *q,
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera_common.h">
     camera_metadata_t
    </a>
    **buffer)
   </td>
  </tr>
  <tr class="separator:a79adee987dbd6a8ea0cfab81c89ae579">
   <td class="memSeparator" colspan="2">
    &#160;
   </td>
  </tr>
  <tr class="memitem:aa45ae2fd2aedf1843378e213e65a66f8">
   <td class="memItemLeft" align="right" valign="top">
    int(*&#160;
   </td>
   <td class="memItemRight" valign="bottom">
    <a class="el" href="structcamera2__request__queue__src__ops.html#aa45ae2fd2aedf1843378e213e65a66f8">
     free_request
    </a>
    )(const struct
    <a class="el" href="structcamera2__request__queue__src__ops.html">
     camera2_request_queue_src_ops
    </a>
    *q,
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera_common.h">
     camera_metadata_t
    </a>
    *old_buffer)
   </td>
  </tr>
  <tr class="separator:aa45ae2fd2aedf1843378e213e65a66f8">
   <td class="memSeparator" colspan="2">
    &#160;
   </td>
  </tr>
 </table>
 <a name="details" id="details">
 </a>
 <h2 class="groupheader">
  Detailed Description
 </h2>
 <div class="textblock">
  <p>
   Request input queue protocol:
  </p>
  <p>
   The framework holds the queue and its contents. At start, the queue is empty.
  </p>
  <ol type="1">
   <li>
    When the first metadata buffer is placed into the queue, the framework signals the device by calling notify_request_queue_not_empty().
   </li>
   <li>
    After receiving notify_request_queue_not_empty, the device must call dequeue() once it's ready to handle the next buffer.
   </li>
   <li>
    Once the device has processed a buffer, and is ready for the next buffer, it must call dequeue() again instead of waiting for a notification. If there are no more buffers available, dequeue() will return NULL. After this point, when a buffer becomes available, the framework must call notify_request_queue_not_empty() again. If the device receives a NULL return from dequeue, it does not need to query the queue again until a notify_request_queue_not_empty() call is received from the source.
   </li>
   <li>
    If the device calls buffer_count() and receives 0, this does not mean that the framework will provide a notify_request_queue_not_empty() call. The framework will only provide such a notification after the device has received a NULL from dequeue, or on initial startup.
   </li>
   <li>
    The dequeue() call in response to notify_request_queue_not_empty() may be on the same thread as the notify_request_queue_not_empty() call, and may be performed from within the notify call.
   </li>
   <li>
    All dequeued request buffers must be returned to the framework by calling free_request, including when errors occur, a device flush is requested, or when the device is shutting down.
   </li>
  </ol>
  <p>
   Definition at line
   <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera2.h">
    220
   </a>
   of file
   <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera2.h">
    camera2.h
   </a>
   .
  </p>
 </div>
 <h2 class="groupheader">
  Field Documentation
 </h2>
 <a class="anchor" id="a79adee987dbd6a8ea0cfab81c89ae579">
 </a>
 <div class="memitem">
  <div class="memproto">
   <table class="memname">
    <tr>
     <td class="memname">
      int(* dequeue_request)(const struct
      <a class="el" href="structcamera2__request__queue__src__ops.html">
       camera2_request_queue_src_ops
      </a>
      *q,
      <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera_common.h">
       camera_metadata_t
      </a>
      **buffer)
     </td>
    </tr>
   </table>
  </div>
  <div class="memdoc">
   <p>
    Get a metadata buffer from the framework. Returns OK if there is no error. If the queue is empty, returns NULL in buffer. In that case, the device must wait for a notify_request_queue_not_empty() message before attempting to dequeue again. Buffers obtained in this way must be returned to the framework with
    <a class="el" href="structcamera2__request__queue__src__ops.html#aa45ae2fd2aedf1843378e213e65a66f8">
     free_request()
    </a>
    .
   </p>
   <p>
    Definition at line
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera2.h">
     237
    </a>
    of file
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera2.h">
     camera2.h
    </a>
    .
   </p>
  </div>
 </div>
 <a class="anchor" id="aa45ae2fd2aedf1843378e213e65a66f8">
 </a>
 <div class="memitem">
  <div class="memproto">
   <table class="memname">
    <tr>
     <td class="memname">
      int(* free_request)(const struct
      <a class="el" href="structcamera2__request__queue__src__ops.html">
       camera2_request_queue_src_ops
      </a>
      *q,
      <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera_common.h">
       camera_metadata_t
      </a>
      *old_buffer)
     </td>
    </tr>
   </table>
  </div>
  <div class="memdoc">
   <p>
    Return a metadata buffer to the framework once it has been used, or if an error or shutdown occurs.
   </p>
   <p>
    Definition at line
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera2.h">
     243
    </a>
    of file
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera2.h">
     camera2.h
    </a>
    .
   </p>
  </div>
 </div>
 <a class="anchor" id="a19ec09251038ee392fedcaeb68ede229">
 </a>
 <div class="memitem">
  <div class="memproto">
   <table class="memname">
    <tr>
     <td class="memname">
      int(* request_count)(const struct
      <a class="el" href="structcamera2__request__queue__src__ops.html">
       camera2_request_queue_src_ops
      </a>
      *q)
     </td>
    </tr>
   </table>
  </div>
  <div class="memdoc">
   <p>
    Get the count of request buffers pending in the queue. May return CAMERA2_REQUEST_QUEUE_IS_BOTTOMLESS if a repeating request (stream request) is currently configured. Calling this method has no effect on whether the notify_request_queue_not_empty() method will be called by the framework.
   </p>
   <p>
    Definition at line
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera2.h">
     228
    </a>
    of file
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera2.h">
     camera2.h
    </a>
    .
   </p>
  </div>
 </div>
 <hr />
 The documentation for this struct was generated from the following file:
 <ul>
  <li>
   hardware/libhardware/include/hardware/
   <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera2.h">
    camera2.h
   </a>
  </li>
 </ul>
</div>
<!-- contents -->
</div>

</body>
</html>
