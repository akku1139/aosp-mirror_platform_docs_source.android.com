<!DOCTYPE html>
<html devsite>
<head>
  <title>Android Hardware Abstraction Layer: camera3_callback_ops Struct Reference</title>
  <meta name="project_path" value="/_project.yaml" />
  <meta name="book_path" value="/_book.yaml" />
  <meta name="hide_page_heading" value="true" />
</head>
<body>
  <div id="top"><!-- do not remove this div --></div>
  <h1><div class="title">camera3_callback_ops Struct Reference</div></h1>

<div id="doc-content">
<div class="header">
 <div class="summary">
  <a href="#pub-attribs">
   Data Fields
  </a>
 </div>
 <div class="headertitle">
  <div class="title">
   camera3_callback_ops Struct Reference
  </div>
 </div>
</div>
<!--header-->
<div class="contents">
 <p>
  <code>
   #include &lt;
   <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera3.h">
    camera3.h
   </a>
   &gt;
  </code>
 </p>
 <table class="memberdecls">
  <tr class="heading">
   <td colspan="2">
    <h2 class="groupheader">
     <a name="pub-attribs">
     </a>
     Data Fields
    </h2>
   </td>
  </tr>
  <tr class="memitem:a2f7cf688a195532999b8498d6ef15e45">
   <td class="memItemLeft" align="right" valign="top">
    void(*&#160;
   </td>
   <td class="memItemRight" valign="bottom">
    <a class="el" href="structcamera3__callback__ops.html#a2f7cf688a195532999b8498d6ef15e45">
     process_capture_result
    </a>
    )(const struct
    <a class="el" href="structcamera3__callback__ops.html">
     camera3_callback_ops
    </a>
    *, const
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera3.h">
     camera3_capture_result_t
    </a>
    *result)
   </td>
  </tr>
  <tr class="separator:a2f7cf688a195532999b8498d6ef15e45">
   <td class="memSeparator" colspan="2">
    &#160;
   </td>
  </tr>
  <tr class="memitem:a6d702d6e962f95105b984b17462619b3">
   <td class="memItemLeft" align="right" valign="top">
    void(*&#160;
   </td>
   <td class="memItemRight" valign="bottom">
    <a class="el" href="structcamera3__callback__ops.html#a6d702d6e962f95105b984b17462619b3">
     notify
    </a>
    )(const struct
    <a class="el" href="structcamera3__callback__ops.html">
     camera3_callback_ops
    </a>
    *, const
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera3.h">
     camera3_notify_msg_t
    </a>
    *msg)
   </td>
  </tr>
  <tr class="separator:a6d702d6e962f95105b984b17462619b3">
   <td class="memSeparator" colspan="2">
    &#160;
   </td>
  </tr>
 </table>
 <a name="details" id="details">
 </a>
 <h2 class="groupheader">
  Detailed Description
 </h2>
 <div class="textblock">
  <p>
   Definition at line
   <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera3.h">
    2397
   </a>
   of file
   <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera3.h">
    camera3.h
   </a>
   .
  </p>
 </div>
 <h2 class="groupheader">
  Field Documentation
 </h2>
 <a class="anchor" id="a6d702d6e962f95105b984b17462619b3">
 </a>
 <div class="memitem">
  <div class="memproto">
   <table class="memname">
    <tr>
     <td class="memname">
      void(* notify)(const struct
      <a class="el" href="structcamera3__callback__ops.html">
       camera3_callback_ops
      </a>
      *, const
      <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera3.h">
       camera3_notify_msg_t
      </a>
      *msg)
     </td>
    </tr>
   </table>
  </div>
  <div class="memdoc">
   <p>
    notify:
   </p>
   <p>
    Asynchronous notification callback from the HAL, fired for various reasons. Only for information independent of frame capture, or that require specific timing. The ownership of the message structure remains with the HAL, and the msg only needs to be valid for the duration of this call.
   </p>
   <p>
    Multiple threads may call
    <a class="el" href="structcamera3__callback__ops.html#a6d702d6e962f95105b984b17462619b3">
     notify()
    </a>
    simultaneously.
   </p>
   <p>
    &lt;= CAMERA_DEVICE_API_VERSION_3_1:
   </p>
   <p>
    The notification for the start of exposure for a given request must be sent by the HAL before the first call to
    <a class="el" href="structcamera3__callback__ops.html#a2f7cf688a195532999b8498d6ef15e45">
     process_capture_result()
    </a>
    for that request is made.
   </p>
   <p>
    &gt;= CAMERA_DEVICE_API_VERSION_3_2:
   </p>
   <p>
    Buffers delivered to the framework will not be dispatched to the application layer until a start of exposure timestamp (or input image's start of exposure timestamp for a reprocess request) has been received via a SHUTTER
    <a class="el" href="structcamera3__callback__ops.html#a6d702d6e962f95105b984b17462619b3">
     notify()
    </a>
    call. It is highly recommended to dispatch this call as early as possible.
   </p>
   <hr />
   <p>
    Performance requirements:
   </p>
   <p>
    This is a non-blocking call. The framework will return this call in 5ms.
   </p>
   <p>
    Definition at line
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera3.h">
     2499
    </a>
    of file
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera3.h">
     camera3.h
    </a>
    .
   </p>
  </div>
 </div>
 <a class="anchor" id="a2f7cf688a195532999b8498d6ef15e45">
 </a>
 <div class="memitem">
  <div class="memproto">
   <table class="memname">
    <tr>
     <td class="memname">
      void(* process_capture_result)(const struct
      <a class="el" href="structcamera3__callback__ops.html">
       camera3_callback_ops
      </a>
      *, const
      <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera3.h">
       camera3_capture_result_t
      </a>
      *result)
     </td>
    </tr>
   </table>
  </div>
  <div class="memdoc">
   <p>
    process_capture_result:
   </p>
   <p>
    Send results from a completed capture to the framework.
    <a class="el" href="structcamera3__callback__ops.html#a2f7cf688a195532999b8498d6ef15e45">
     process_capture_result()
    </a>
    may be invoked multiple times by the HAL in response to a single capture request. This allows, for example, the metadata and low-resolution buffers to be returned in one call, and post-processed JPEG buffers in a later call, once it is available. Each call must include the frame number of the request it is returning metadata or buffers for.
   </p>
   <p>
    A component (buffer or metadata) of the complete result may only be included in one process_capture_result call. A buffer for each stream, and the result metadata, must be returned by the HAL for each request in one of the process_capture_result calls, even in case of errors producing some of the output. A call to
    <a class="el" href="structcamera3__callback__ops.html#a2f7cf688a195532999b8498d6ef15e45">
     process_capture_result()
    </a>
    with neither output buffers or result metadata is not allowed.
   </p>
   <p>
    The order of returning metadata and buffers for a single result does not matter, but buffers for a given stream must be returned in FIFO order. So the buffer for request 5 for stream A must always be returned before the buffer for request 6 for stream A. This also applies to the result metadata; the metadata for request 5 must be returned before the metadata for request 6.
   </p>
   <p>
    However, different streams are independent of each other, so it is acceptable and expected that the buffer for request 5 for stream A may be returned after the buffer for request 6 for stream B is. And it is acceptable that the result metadata for request 6 for stream B is returned before the buffer for request 5 for stream A is.
   </p>
   <p>
    The HAL retains ownership of result structure, which only needs to be valid to access during this call. The framework will copy whatever it needs before this call returns.
   </p>
   <p>
    The output buffers do not need to be filled yet; the framework will wait on the stream buffer release sync fence before reading the buffer data. Therefore, this method should be called by the HAL as soon as possible, even if some or all of the output buffers are still in being filled. The HAL must include valid release sync fences into each output_buffers stream buffer entry, or -1 if that stream buffer is already filled.
   </p>
   <p>
    If the result buffer cannot be constructed for a request, the HAL should return an empty metadata buffer, but still provide the output buffers and their sync fences. In addition,
    <a class="el" href="structcamera3__callback__ops.html#a6d702d6e962f95105b984b17462619b3">
     notify()
    </a>
    must be called with an ERROR_RESULT message.
   </p>
   <p>
    If an output buffer cannot be filled, its status field must be set to STATUS_ERROR. In addition,
    <a class="el" href="structcamera3__callback__ops.html#a6d702d6e962f95105b984b17462619b3">
     notify()
    </a>
    must be called with a ERROR_BUFFER message.
   </p>
   <p>
    If the entire capture has failed, then this method still needs to be called to return the output buffers to the framework. All the buffer statuses should be STATUS_ERROR, and the result metadata should be an empty buffer. In addition,
    <a class="el" href="structcamera3__callback__ops.html#a6d702d6e962f95105b984b17462619b3">
     notify()
    </a>
    must be called with a ERROR_REQUEST message. In this case, individual ERROR_RESULT/ERROR_BUFFER messages should not be sent.
   </p>
   <p>
    Performance requirements:
   </p>
   <p>
    This is a non-blocking call. The framework will return this call in 5ms.
   </p>
   <p>
    The pipeline latency (see S7 for definition) should be less than or equal to 4 frame intervals, and must be less than or equal to 8 frame intervals.
   </p>
   <p>
    Definition at line
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera3.h">
     2466
    </a>
    of file
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera3.h">
     camera3.h
    </a>
    .
   </p>
  </div>
 </div>
 <hr />
 The documentation for this struct was generated from the following file:
 <ul>
  <li>
   hardware/libhardware/include/hardware/
   <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/camera3.h">
    camera3.h
   </a>
  </li>
 </ul>
</div>
<!-- contents -->
</div>

</body>
</html>
