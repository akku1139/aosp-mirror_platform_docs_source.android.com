<!DOCTYPE html>
<html devsite>
<head>
  <title>Android Hardware Abstraction Layer: gatekeeper_device Struct Reference</title>
  <meta name="project_path" value="/_project.yaml" />
  <meta name="book_path" value="/_book.yaml" />
  <meta name="hide_page_heading" value="true" />
</head>
<body>
  <div id="top"><!-- do not remove this div --></div>
  <h1><div class="title">gatekeeper_device Struct Reference</div></h1>

<div id="doc-content">
<div class="header">
 <div class="summary">
  <a href="#pub-attribs">
   Data Fields
  </a>
 </div>
 <div class="headertitle">
  <div class="title">
   gatekeeper_device Struct Reference
  </div>
 </div>
</div>
<!--header-->
<div class="contents">
 <p>
  <code>
   #include &lt;
   <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/gatekeeper.h">
    gatekeeper.h
   </a>
   &gt;
  </code>
 </p>
 <table class="memberdecls">
  <tr class="heading">
   <td colspan="2">
    <h2 class="groupheader">
     <a name="pub-attribs">
     </a>
     Data Fields
    </h2>
   </td>
  </tr>
  <tr class="memitem:a75bb16f553e7a3642d7d16e229a1d90d">
   <td class="memItemLeft" align="right" valign="top">
    <a class="el" href="structhw__device__t.html">
     hw_device_t
    </a>
    &#160;
   </td>
   <td class="memItemRight" valign="bottom">
    <a class="el" href="structgatekeeper__device.html#a75bb16f553e7a3642d7d16e229a1d90d">
     common
    </a>
   </td>
  </tr>
  <tr class="separator:a75bb16f553e7a3642d7d16e229a1d90d">
   <td class="memSeparator" colspan="2">
    &#160;
   </td>
  </tr>
  <tr class="memitem:a9d3f59541bedeaf4f9d2e6d06b54b33d">
   <td class="memItemLeft" align="right" valign="top">
    int(*&#160;
   </td>
   <td class="memItemRight" valign="bottom">
    <a class="el" href="structgatekeeper__device.html#a9d3f59541bedeaf4f9d2e6d06b54b33d">
     enroll
    </a>
    )(const struct
    <a class="el" href="structgatekeeper__device.html">
     gatekeeper_device
    </a>
    *dev, uint32_t uid, const uint8_t *current_password_handle, uint32_t current_password_handle_length, const uint8_t *current_password, uint32_t current_password_length, const uint8_t *desired_password, uint32_t desired_password_length, uint8_t **enrolled_password_handle, uint32_t *enrolled_password_handle_length)
   </td>
  </tr>
  <tr class="separator:a9d3f59541bedeaf4f9d2e6d06b54b33d">
   <td class="memSeparator" colspan="2">
    &#160;
   </td>
  </tr>
  <tr class="memitem:ac4801fb0c9f8407d817ca85bcf219a7b">
   <td class="memItemLeft" align="right" valign="top">
    int(*&#160;
   </td>
   <td class="memItemRight" valign="bottom">
    <a class="el" href="structgatekeeper__device.html#ac4801fb0c9f8407d817ca85bcf219a7b">
     verify
    </a>
    )(const struct
    <a class="el" href="structgatekeeper__device.html">
     gatekeeper_device
    </a>
    *dev, uint32_t uid, uint64_t challenge, const uint8_t *enrolled_password_handle, uint32_t enrolled_password_handle_length, const uint8_t *provided_password, uint32_t provided_password_length, uint8_t **auth_token, uint32_t *auth_token_length, bool *request_reenroll)
   </td>
  </tr>
  <tr class="separator:ac4801fb0c9f8407d817ca85bcf219a7b">
   <td class="memSeparator" colspan="2">
    &#160;
   </td>
  </tr>
  <tr class="memitem:abd08ba7f0432c98c69d9982d3686b967">
   <td class="memItemLeft" align="right" valign="top">
    int(*&#160;
   </td>
   <td class="memItemRight" valign="bottom">
    <a class="el" href="structgatekeeper__device.html#abd08ba7f0432c98c69d9982d3686b967">
     delete_user
    </a>
    )(const struct
    <a class="el" href="structgatekeeper__device.html">
     gatekeeper_device
    </a>
    *dev, uint32_t uid)
   </td>
  </tr>
  <tr class="separator:abd08ba7f0432c98c69d9982d3686b967">
   <td class="memSeparator" colspan="2">
    &#160;
   </td>
  </tr>
  <tr class="memitem:ac1a13446719a1fcbe0f7e1c8d6a80c82">
   <td class="memItemLeft" align="right" valign="top">
    int(*&#160;
   </td>
   <td class="memItemRight" valign="bottom">
    <a class="el" href="structgatekeeper__device.html#ac1a13446719a1fcbe0f7e1c8d6a80c82">
     delete_all_users
    </a>
    )(const struct
    <a class="el" href="structgatekeeper__device.html">
     gatekeeper_device
    </a>
    *dev)
   </td>
  </tr>
  <tr class="separator:ac1a13446719a1fcbe0f7e1c8d6a80c82">
   <td class="memSeparator" colspan="2">
    &#160;
   </td>
  </tr>
 </table>
 <a name="details" id="details">
 </a>
 <h2 class="groupheader">
  Detailed Description
 </h2>
 <div class="textblock">
  <p>
   Definition at line
   <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/gatekeeper.h">
    41
   </a>
   of file
   <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/gatekeeper.h">
    gatekeeper.h
   </a>
   .
  </p>
 </div>
 <h2 class="groupheader">
  Field Documentation
 </h2>
 <a class="anchor" id="a75bb16f553e7a3642d7d16e229a1d90d">
 </a>
 <div class="memitem">
  <div class="memproto">
   <table class="memname">
    <tr>
     <td class="memname">
      <a class="el" href="structhw__device__t.html">
       hw_device_t
      </a>
      common
     </td>
    </tr>
   </table>
  </div>
  <div class="memdoc">
   <p>
    Common methods of the gatekeeper device. As above, this must be the first member of keymaster_device.
   </p>
   <p>
    Definition at line
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/gatekeeper.h">
     46
    </a>
    of file
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/gatekeeper.h">
     gatekeeper.h
    </a>
    .
   </p>
  </div>
 </div>
 <a class="anchor" id="ac1a13446719a1fcbe0f7e1c8d6a80c82">
 </a>
 <div class="memitem">
  <div class="memproto">
   <table class="memname">
    <tr>
     <td class="memname">
      int(* delete_all_users)(const struct
      <a class="el" href="structgatekeeper__device.html">
       gatekeeper_device
      </a>
      *dev)
     </td>
    </tr>
   </table>
  </div>
  <div class="memdoc">
   <p>
    Definition at line
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/gatekeeper.h">
     173
    </a>
    of file
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/gatekeeper.h">
     gatekeeper.h
    </a>
    .
   </p>
  </div>
 </div>
 <a class="anchor" id="abd08ba7f0432c98c69d9982d3686b967">
 </a>
 <div class="memitem">
  <div class="memproto">
   <table class="memname">
    <tr>
     <td class="memname">
      int(* delete_user)(const struct
      <a class="el" href="structgatekeeper__device.html">
       gatekeeper_device
      </a>
      *dev, uint32_t uid)
     </td>
    </tr>
   </table>
  </div>
  <div class="memdoc">
   <p>
    Definition at line
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/gatekeeper.h">
     159
    </a>
    of file
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/gatekeeper.h">
     gatekeeper.h
    </a>
    .
   </p>
  </div>
 </div>
 <a class="anchor" id="a9d3f59541bedeaf4f9d2e6d06b54b33d">
 </a>
 <div class="memitem">
  <div class="memproto">
   <table class="memname">
    <tr>
     <td class="memname">
      int(* enroll)(const struct
      <a class="el" href="structgatekeeper__device.html">
       gatekeeper_device
      </a>
      *dev, uint32_t uid, const uint8_t *current_password_handle, uint32_t current_password_handle_length, const uint8_t *current_password, uint32_t current_password_length, const uint8_t *desired_password, uint32_t desired_password_length, uint8_t **enrolled_password_handle, uint32_t *enrolled_password_handle_length)
     </td>
    </tr>
   </table>
  </div>
  <div class="memdoc">
   <p>
    Enrolls desired_password, which should be derived from a user selected pin or password, with the authentication factor private key used only for enrolling authentication factor data.
   </p>
   <p>
    If there was already a password enrolled, it should be provided in current_password_handle, along with the current password in current_password that should validate against current_password_handle.
   </p>
   <p>
    Parameters:
   </p>
   <ul>
    <li>
     dev: pointer to
     <a class="el" href="structgatekeeper__device.html">
      gatekeeper_device
     </a>
     acquired via calls to gatekeeper_open
    </li>
    <li>
     uid: the Android user identifier
    </li>
    <li>
     current_password_handle: the currently enrolled password handle the user wants to replace. May be null if there's no currently enrolled password.
    </li>
    <li>
     current_password_handle_length: the length in bytes of the buffer pointed at by current_password_handle. Must be 0 if current_password_handle is NULL.
    </li>
    <li>
     current_password: the user's current password in plain text. If presented, it MUST verify against current_password_handle.
    </li>
    <li>
     current_password_length: the size in bytes of the buffer pointed at by current_password. Must be 0 if the current_password is NULL.
    </li>
    <li>
     desired_password: the new password the user wishes to enroll in plain-text. Cannot be NULL.
    </li>
    <li>
     desired_password_length: the length in bytes of the buffer pointed at by desired_password.
    </li>
    <li>
     enrolled_password_handle: on success, a buffer will be allocated with the new password handle referencing the password provided in desired_password. This buffer can be used on subsequent calls to enroll or verify. The caller is responsible for deallocating this buffer via a call to delete[]
    </li>
    <li>
     enrolled_password_handle_length: pointer to the length in bytes of the buffer allocated by this function and pointed to by *enrolled_password_handle_length.
    </li>
   </ul>
   <p>
    Returns:
   </p>
   <ul>
    <li>
     0 on success
    </li>
    <li>
     An error code &lt; 0 on failure, or
    </li>
    <li>
     A timeout value T &gt; 0 if the call should not be re-attempted until T milliseconds have elapsed.
    </li>
   </ul>
   <p>
    On error, enrolled_password_handle will not be allocated.
   </p>
   <p>
    Definition at line
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/gatekeeper.h">
     91
    </a>
    of file
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/gatekeeper.h">
     gatekeeper.h
    </a>
    .
   </p>
  </div>
 </div>
 <a class="anchor" id="ac4801fb0c9f8407d817ca85bcf219a7b">
 </a>
 <div class="memitem">
  <div class="memproto">
   <table class="memname">
    <tr>
     <td class="memname">
      int(* verify)(const struct
      <a class="el" href="structgatekeeper__device.html">
       gatekeeper_device
      </a>
      *dev, uint32_t uid, uint64_t challenge, const uint8_t *enrolled_password_handle, uint32_t enrolled_password_handle_length, const uint8_t *provided_password, uint32_t provided_password_length, uint8_t **auth_token, uint32_t *auth_token_length, bool *request_reenroll)
     </td>
    </tr>
   </table>
  </div>
  <div class="memdoc">
   <p>
    Verifies provided_password matches enrolled_password_handle.
   </p>
   <p>
    Implementations of this module may retain the result of this call to attest to the recency of authentication.
   </p>
   <p>
    On success, writes the address of a verification token to auth_token, usable to attest password verification to other trusted services. Clients may pass NULL for this value.
   </p>
   <p>
    Parameters:
   </p>
   <ul>
    <li>
     dev: pointer to
     <a class="el" href="structgatekeeper__device.html">
      gatekeeper_device
     </a>
     acquired via calls to gatekeeper_open
    </li>
    <li>
     uid: the Android user identifier
    </li>
    <li>
     challenge: An optional challenge to authenticate against, or 0. Used when a separate authenticator requests password verification, or for transactional password authentication.
    </li>
    <li>
     enrolled_password_handle: the currently enrolled password handle that the user wishes to verify against.
    </li>
    <li>
     enrolled_password_handle_length: the length in bytes of the buffer pointed to by enrolled_password_handle
    </li>
    <li>
     provided_password: the plaintext password to be verified against the enrolled_password_handle
    </li>
    <li>
     provided_password_length: the length in bytes of the buffer pointed to by provided_password
    </li>
    <li>
     auth_token: on success, a buffer containing the authentication token resulting from this verification is assigned to *auth_token. The caller is responsible for deallocating this memory via a call to delete[]
    </li>
    <li>
     auth_token_length: on success, the length in bytes of the authentication token assigned to *auth_token will be assigned to *auth_token_length
    </li>
    <li>
     request_reenroll: a request to the upper layers to re-enroll the verified password due to a version change. Not set if verification fails.
    </li>
   </ul>
   <p>
    Returns:
   </p>
   <ul>
    <li>
     0 on success
    </li>
    <li>
     An error code &lt; 0 on failure, or
    </li>
    <li>
     A timeout value T &gt; 0 if the call should not be re-attempted until T milliseconds have elapsed. On error, auth token will not be allocated
    </li>
   </ul>
   <p>
    Definition at line
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/gatekeeper.h">
     141
    </a>
    of file
    <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/gatekeeper.h">
     gatekeeper.h
    </a>
    .
   </p>
  </div>
 </div>
 <hr />
 The documentation for this struct was generated from the following file:
 <ul>
  <li>
   hardware/libhardware/include/hardware/
   <a class="el" href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware/gatekeeper.h">
    gatekeeper.h
   </a>
  </li>
 </ul>
</div>
<!-- contents -->
</div>

</body>
</html>
