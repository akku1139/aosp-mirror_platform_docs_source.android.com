<html devsite><head>
    <title>Compatibilidade com versões anteriores</title>
    <meta name="project_path" value="/_project.yaml"/>
    <meta name="book_path" value="/_book.yaml"/>
  </head>
  <body>

  <!--
      Copyright 2017 The Android Open Source Project

      Licensed under the Apache License, Version 2.0 (the "License");
      you may not use this file except in compliance with the License.
      You may obtain a copy of the License at

          http://www.apache.org/licenses/LICENSE-2.0

      Unless required by applicable law or agreed to in writing, software
      distributed under the License is distributed on an "AS IS" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
      See the License for the specific language governing permissions and
      limitations under the License.
  -->

<p class="note"><strong>Observação:</strong> estes requisitos se aplicam apenas à criação de versões mais antigas do Android. Para o branch <code>master</code> do Android Open Source Project (AOSP), consulte os <a href="requirements">Requisitos padrão</a> e <a href="initializing">Como estabelecer um ambiente de criação</a>.
</p>

<h2 id="building-recent-old-releases">Criar versões anteriores recentes (5.0 Lollipop e posteriores)</h2>

<p>
  Para as versões 8.0 (Oreo ou O) a 5.0 (Lollipop ou L) do Android, considere o uso do <a href="https://android.googlesource.com/platform/build/+/master/tools/docker" class="external">Dockerfile</a> incluído para facilitar a instalação de todos os pacotes necessários.</p>

<h2 id="building-really-old-releases">Criar versões muito antigas (4.4 KitKat e anteriores)</h2>

<h3 id="operating-systems">Sistemas operacionais</h3>
<p>
  O Android normalmente é criado com um sistema operacional GNU/Linux ou Mac OS. Também é possível criá-lo em uma máquina virtual em sistemas não compatíveis, como o Windows.
</p>

<p>Recomendamos a criação no GNU/Linux. O sistema de criação do Android normalmente executa o ART na máquina de criação para pré-compilar arquivos DEX do sistema. Como o ART só pode ser executado no Linux, o sistema de compilação ignora essa etapa de pré-compilação em sistemas operacionais não Linux, resultando em uma versão do Android com desempenho reduzido.
</p>

<h4 id="linux">GNU/Linux</h4>
<ul>
  <li>Android 6.0 (Marshmallow) a AOSP mestre: Ubuntu 14.04 (Trusty)</li>
  <li>Android 2.3.x (Gingerbread) a Android 5.x (Lollipop): Ubuntu 12.04 (Precise)</li>
  <li>Android 1.5 (Cupcake) a Android 2.2.x (Froyo): Ubuntu 10.04 (Lucid)</li>
</ul>
<h4 id="mac">Mac OS X (Intel/x86)</h4>
<ul>
  <li>Android 6.0 (Marshmallow) a AOSP mestre: Mac OS v10.10 (Yosemite) ou posterior com o Xcode 4.5.2 e ferramentas de linha de comando
  </li>
  <li>Android 5.x (Lollipop): Mac OS v10.8 (Mountain Lion) com Xcode 4.5.2 e ferramentas de linha de comando
  </li>
  <li>Android 4.1.x (Jelly Bean) a Android 4.4.x (KitKat): Mac OS X v10.6 (Snow Leopard) ou Mac OS X v10.7 (Lion) e Xcode 4.2 (Ferramentas para Desenvolvedores da Apple)
  </li>
  <li>Android 1.5 (Cupcake) a Android 4.0.x (Ice Cream Sandwich): Mac OS v10.5 (Leopard) ou Mac OS X v10.6 (Snow Leopard) e o SDK do Mac OS X v10.5
  </li>
</ul>

<h3 id="make">GNU Make</h3>

<p>
  Para versões anteriores ao branch mestre do AOSP no Android 4.1.x (Jelly Bean), use o <a href="http://ftp.gnu.org/gnu/make/" class="external">GNU Make (gmake) 3.82</a>.
  Para o Android 4.0.x (Ice Cream Sandwich) e versões anteriores, <a href="#reverting-from-make-382">reverta a partir do gmake 3.82</a> para evitar erros de compilação.
</p>

<h4 id="xcode-other-packages">Xcode e outros pacotes</h4>
<p>
    Para versões anteriores do Mac OS X (10.8 ou anteriores), instale o Xcode no <a href="http://developer.apple.com/" class="external">site da Apple para desenvolvedores</a> (link em inglês). Se você ainda não está registrado como desenvolvedor da Apple, crie um ID Apple para fazer o download.
</p>
<p>
    Se estiver usando o Mac OS X v10.4, instale também o Bison:
    </p><pre class="devsite-terminal devsite-click-to-copy">
    POSIXLY_CORRECT=1 sudo port install bison</pre>
<p></p>

<p>
    Para MacPorts, emita:
    </p><pre class="devsite-terminal devsite-click-to-copy">
    POSIXLY_CORRECT=1 sudo port install gmake libsdl git gnupg</pre>
<p></p>

<p>
    Para Homebrew, emita:
    </p><pre class="devsite-terminal devsite-click-to-copy">
    brew install gmake libsdl git gnupg2</pre>
<p></p>

<h4 id="reverting-from-make-382">Como reverter do gmake 3.82</h4>
<p>
  No Android 4.0.x (Ice Cream Sandwich) e versões anteriores, há um bug no gmake 3.82 que impede a criação do Android. Você pode instalar a versão 3.81 usando o MacPorts com estas etapas:
</p>
<ol>
  <li>Edite <code>/opt/local/etc/macports/sources.conf</code> e adicione esta linha:
    <pre class="devsite-click-to-copy">
    file:///Users/Shared/dports</pre>
    acima da linha rsync. Em seguida, crie este diretório:
    <pre class="devsite-terminal devsite-click-to-copy">
    mkdir /Users/Shared/dports</pre>
  </li>
  <li>No novo diretório <code>dports</code>, execute:
    <pre class="devsite-terminal devsite-click-to-copy">
    svn co --revision 50980 http://svn.macports.org/repository/macports/trunk/dports/devel/gmake/ devel/gmake/</pre>
  </li>
  <li>Crie um índice de porta para seu novo repositório local:
    <pre class="devsite-terminal devsite-click-to-copy">
    portindex /Users/Shared/dports</pre>
  </li>
  <li>Instale a versão anterior do gmake:
    <pre class="devsite-terminal devsite-click-to-copy">
    sudo port install gmake @3.81</pre>
  </li>
</ol>

<h3 id="jdk">JDK</h3>
<h4 id="supported-versions">Versões compatíveis</h4>

<ul>
<li>Android 7.0 (Nougat) a Android 8.0 (Oreo):
    <ul>
    <li>Ubuntu: <a href="http://openjdk.java.net/install/" class="external">OpenJDK 8</a></li>
    <li>Mac OS X: <a href="http://www.oracle.com/technetwork/java/javase/downloads/java-archive-javase8-2177648.html#jdk-8u45-oth-JPR" class="external">JDK 8u45 ou posterior</a></li>
    </ul>
  </li>
<li>Android 5.x (Lollipop) a Android 6.0 (Marshmallow):
    <ul>
      <li>Ubuntu: <a href="http://openjdk.java.net/install/" class="external">OpenJDK 7</a></li>
    <li>Mac OS X: <a href="https://www.oracle.com/technetwork/java/javase/downloads/java-archive-downloads-javase7-521261.html#jdk-7u71-oth-JPR" class="external">jdk-7u71-macosx-x64.dmg</a></li>
    </ul>
  </li>
<li>Android 2.3.x (Gingerbread) a Android 4.4.x (KitKat):
    <ul>
      <li>Ubuntu: <a href="http://www.oracle.com/technetwork/java/javase/archive-139210.html" class="external">Java JDK 6</a></li>
        <li>Mac OS X: <a href="http://support.apple.com/kb/dl1572" class="external">Java JDK 6</a></li>
    </ul>
  </li>
<li>Android 1.5 (Cupcake) a Android 2.2.x (Froyo):
    <ul>
    <li>Ubuntu: <a href="http://www.oracle.com/technetwork/java/javase/archive-139210.html" class="external">Java JDK 5</a></li>
    </ul>
  </li>
</ul>

<h4 id="jdk-linux">JDK para Linux</h4>

<p>
  O branch <code>master</code> do Android no <a href="https://android.googlesource.com/" class="external">AOSP</a> (link em inglês) vem com versões pré-criadas do OpenJDK abaixo de <code>prebuilts/jdk/</code>, então nenhuma outra instalação é necessária.
</p>
<p>
  As versões mais antigas do Android exigem uma instalação separada do JDK. No Ubuntu, use o <a href="http://openjdk.java.net/install/" class="external">OpenJDK</a> (link em inglês).</p>
<h4 id="for-ubuntu-15-04">Para o Ubuntu 15.04 e versões posteriores</h4>
<p>
  Execute o comando a seguir:
</p>
<pre class="devsite-click-to-copy">
<code class="devsite-terminal">sudo apt-get update</code>
<code class="devsite-terminal">sudo apt-get install openjdk-8-jdk</code>
</pre>

<h4 id="for-ubuntu-14-04">Para o Ubuntu LTS 14.04</h4>
<p>
  Não há pacotes OpenJDK 8 compatíveis disponíveis para o Ubuntu 14.04. Os pacotes do <strong>Ubuntu 15.04 OpenJDK 8</strong> foram usados com êxito com o Ubuntu 14.04. <em>Versões de pacote mais recentes (por exemplo, aquelas para o 15.10 e o 16.04) não funcionam no 14.04 com as instruções abaixo.</em>
</p>
<ol>
  <li>Faça o download dos pacotes <code>.deb</code> para a arquitetura de 64 bits em <a href="http://old-releases.ubuntu.com/ubuntu/pool/universe/o/openjdk-8/" class="external">old-releases.ubuntu.com</a> (link em inglês):
    <ul>
      <li><a href="http://old-releases.ubuntu.com/ubuntu/pool/universe/o/openjdk-8/openjdk-8-jre-headless_8u45-b14-1_amd64.deb" class="external">openjdk-8-jre-headless_8u45-b14-1_amd64.deb</a> com SHA256 <code>0f5aba8db39088283b51e00054813063173a4d8809f70033976f83e214ab56c0</code>
      </li>
      <li><a href="http://old-releases.ubuntu.com/ubuntu/pool/universe/o/openjdk-8/openjdk-8-jre_8u45-b14-1_amd64.deb" class="external">openjdk-8-jre_8u45-b14-1_amd64.deb</a> com SHA256 <code>9ef76c4562d39432b69baf6c18f199707c5c56a5b4566847df908b7d74e15849</code>
      </li>
      <li><a href="http://old-releases.ubuntu.com/ubuntu/pool/universe/o/openjdk-8/openjdk-8-jdk_8u45-b14-1_amd64.deb" class="external">openjdk-8-jdk_8u45-b14-1_amd64.deb</a> com SHA256 <code>6e47215cf6205aa829e6a0a64985075bd29d1f428a4006a80c9db371c2fc3c4c</code>
      </li>
    </ul>
  </li>
  <li>Outra opção é confirmar as somas de verificação dos arquivos transferidos por download em relação à string SHA256 listada em cada pacote acima. Por exemplo, com a ferramenta <code>sha256sum</code>:
    <pre class="devsite-terminal devsite-click-to-copy">
    sha256sum {downloaded.deb file}</pre>
  </li>
  <li>Instale os pacotes:
    <pre class="devsite-terminal devsite-click-to-copy">
    sudo apt-get update</pre>
    Execute <code>dpkg</code> para cada um dos arquivos <code>.deb</code> que você transferiu por download. Podem ocorrer erros devido à ausência de dependências:
    <pre class="devsite-terminal devsite-click-to-copy">
    sudo dpkg -i {downloaded.deb file}</pre>
    Para corrigir as dependências ausentes:
    <pre class="devsite-terminal devsite-click-to-copy">
    sudo apt-get -f install</pre>
  </li>
</ol>

<h4 id="default-java-version">Atualizar a versão padrão do Java <em>(opcional)</em></h4>
<p>
  Opcionalmente, para as versões do Ubuntu acima, atualize a versão padrão do Java executando:
</p>
<pre class="devsite-click-to-copy">
<code class="devsite-terminal">sudo update-alternatives --config java</code>
<code class="devsite-terminal">sudo update-alternatives --config javac</code>
</pre>
<aside class="note">
  <b>Observação:</b> se, durante uma criação, você encontrar erros de versão para Java, consulte <a href="/setup/build/building#wrong-java-version">Versão incorreta do Java</a> para ver as prováveis causas e soluções.
 </aside>

</body></html>