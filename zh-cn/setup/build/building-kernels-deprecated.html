<html devsite><head>
  <title>编译内核（已弃用）</title>
  <meta name="project_path" value="/_project.yaml"/>
  <meta name="book_path" value="/_book.yaml"/>
</head>
<body>
<!--
    Copyright 2017 The Android Open Source Project

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->

<p>本部分适用于不支持使用 Repo 进行编译的内核。具体来说，此表列出了要手动编译的内核源代码和二进制文件的名称及所在位置。</p>
<table>
  <tbody><tr>
    <th>设备</th>
    <th>二进制文件在 AOSP 树中的位置</th>
    <th>源代码所在的位置</th>
    <th>编译配置</th>
  </tr>
  <tr>
    <td>easel</td>
    <td>N/A</td>
    <td>kernel/arm64</td>
    <td>mnh_prod_defconfig</td>
  </tr>
  <tr>
    <td>angler</td>
    <td>device/huawei/angler-kernel</td>
    <td>kernel/msm</td>
    <td>angler_defconfig</td>
  </tr>
  <tr>
    <td>bullhead</td>
    <td>device/lge/bullhead-kernel</td>
    <td>kernel/msm</td>
    <td>bullhead_defconfig</td>
  </tr>
  <tr>
    <td>shamu</td>
    <td>device/moto/shamu-kernel</td>
    <td>kernel/msm</td>
    <td>shamu_defconfig</td>
  </tr>
  <tr>
    <td>fugu</td>
    <td>device/asus/fugu-kernel</td>
    <td>kernel/x86_64</td>
    <td>fugu_defconfig</td>
  </tr>
  <tr>
    <td>volantis</td>
    <td>device/htc/flounder-kernel</td>
    <td>kernel/tegra</td>
    <td>flounder_defconfig</td>
  </tr>
  <tr>
    <td>hammerhead</td>
    <td>device/lge/hammerhead-kernel</td>
    <td>kernel/msm</td>
    <td>hammerhead_defconfig</td>
  </tr>
  <tr>
    <td>flo</td>
    <td>device/asus/flo-kernel/kernel</td>
    <td>kernel/msm</td>
    <td>flo_defconfig</td>
  </tr>
  <tr>
    <td>deb</td>
    <td>device/asus/flo-kernel/kernel</td>
    <td>kernel/msm</td>
    <td>flo_defconfig</td>
  </tr>
  <tr>
    <td>manta</td>
    <td>device/samsung/manta/kernel</td>
    <td>kernel/exynos</td>
    <td>manta_defconfig</td>
  </tr>
  <tr>
    <td>mako</td>
    <td>device/lge/mako-kernel/kernel</td>
    <td>kernel/msm</td>
    <td>mako_defconfig</td>
  </tr>
  <tr>
    <td>grouper</td>
    <td>device/asus/grouper/kernel</td>
    <td>kernel/tegra</td>
    <td>tegra3_android_defconfig</td>
  </tr>
  <tr>
    <td>tilapia</td>
    <td>device/asus/grouper/kernel</td>
    <td>kernel/tegra</td>
    <td>tegra3_android_defconfig</td>
  </tr>
  <tr>
    <td>maguro</td>
    <td>device/samsung/tuna/kernel</td>
    <td>kernel/omap</td>
    <td>tuna_defconfig</td>
  </tr>
  <tr>
    <td>toro</td>
    <td>device/samsung/tuna/kernel</td>
    <td>kernel/omap</td>
    <td>tuna_defconfig</td>
  </tr>
  <tr>
    <td>panda</td>
    <td>device/ti/panda/kernel</td>
    <td>kernel/omap</td>
    <td>panda_defconfig</td>
  </tr>
  <tr>
    <td>stingray</td>
    <td>device/moto/wingray/kernel</td>
    <td>kernel/tegra</td>
    <td>stingray_defconfig</td>
  </tr>
  <tr>
    <td>wingray</td>
    <td>device/moto/wingray/kernel</td>
    <td>kernel/tegra</td>
    <td>stingray_defconfig</td>
  </tr>
  <tr>
    <td>crespo</td>
    <td>device/samsung/crespo/kernel</td>
    <td>kernel/samsung</td>
    <td>herring_defconfig</td>
  </tr>
  <tr>
    <td>crespo4g</td>
    <td>device/samsung/crespo/kernel</td>
    <td>kernel/samsung</td>
    <td>herring_defconfig</td>
  </tr>
</tbody></table>
<p></p>

<h2 id="downloading-sources">下载源代码</h2>

<p>使用适当的 <code>git clone</code> 命令下载您要编译的内核的源代码。例如，以下命令会克隆用于 HiKey 参考板的 <code>hikey</code> 内核：</p>
<pre class="devsite-terminal devsite-click-to-copy">
git clone https://android.googlesource.com/kernel/hikey-linaro
</pre>

<p>内核项目的完整列表位于 <a href="https://android.googlesource.com/kernel">kernel</a> 目录下。以下是一些常用内核及其各自的 <code>git clone</code> 命令。</p>

<p><code>exynos</code> 项目包含适用于 Nexus 10 的内核源代码，可用作在 Samsung Exynos 芯片组上开展相关工作的着手点。</p>
<pre class="devsite-terminal devsite-click-to-copy">
git clone https://android.googlesource.com/kernel/exynos
</pre>

<p><code>goldfish</code> 项目包含适用于所模拟的平台的内核源代码。</p>
<pre class="devsite-terminal devsite-click-to-copy">
git clone https://android.googlesource.com/kernel/goldfish
</pre>

<p><code>hikey-linaro</code> 项目用于 HiKey 参考板，可用作在 HiSilicon 620 芯片组上开展相关工作的着手点。</p>
<pre class="devsite-terminal devsite-click-to-copy">
git clone https://android.googlesource.com/kernel/hikey-linaro
</pre>

<p><code>msm</code> 项目包含适用于 ADP1、ADP2、Nexus One、Nexus 4、Nexus 5、Nexus 6、Nexus 5X、Nexus 6P、Nexus 7 (2013)、Pixel 和 Pixel XL 的源代码，可用作在 Qualcomm MSM 芯片组上开展相关工作的着手点。</p>
<pre class="devsite-terminal devsite-click-to-copy">
git clone https://android.googlesource.com/kernel/msm
</pre>

<p><code>omap</code> 项目用于 PandaBoard 和 Galaxy Nexus，可用作在 TI OMAP 芯片组上开展相关工作的着手点。</p>
<pre class="devsite-terminal devsite-click-to-copy">
git clone https://android.googlesource.com/kernel/omap
</pre>

<p><code>samsung</code> 项目用于 Nexus S，可用作在 Samsung Hummingbird 芯片组上开展相关工作的着手点。</p>
<pre class="devsite-terminal devsite-click-to-copy">
git clone https://android.googlesource.com/kernel/samsung
</pre>

<p><code>tegra</code> 项目用于 Xoom、Nexus 7 (2012) 和 Nexus 9，可用作在 NVIDIA Tegra 芯片组上开展相关工作的着手点。</p>
<pre class="devsite-terminal devsite-click-to-copy">
git clone https://android.googlesource.com/kernel/tegra
</pre>

<p><code>x86_64</code> 项目包含 Nexus Player 的内核源代码，可用作在 Intel x86_64 芯片组上开展相关工作的着手点。</p>
<pre class="devsite-terminal devsite-click-to-copy">
git clone https://android.googlesource.com/kernel/x86_64
</pre>

<h2 id="building">编译内核</h2>
  <p>如果您不打算编译默认分支（例如 <code>master</code>），则需要在编译之前检出所需的提交。请参阅<a href="/setup/build/building-kernels#id-version">确定内核版本</a>部分，了解如何确定预编译的内核二进制文件的内核版本。现在您可以开始编译内核了。以下编译命令使用了 <code>hikey</code> 内核：</p>
<pre class="devsite-click-to-copy">
<code class="devsite-terminal">cd hikey-linaro</code>
<code class="devsite-terminal">export ARCH=arm64</code>
<code class="devsite-terminal">export CROSS_COMPILE=aarch64-linux-android-</code>
<code class="devsite-terminal">make hikey_defconfig</code>
<code class="devsite-terminal">make</code>
</pre>

<p>要编译不同的内核，只需将 <code>hikey-linaro</code> 替换为您要编译的内核的名称，并将 <code>hikey_defconfig</code> 替换为相应 defconfig 文件的名称即可。</p>

<p>映像会输出到 <code>arch/arm64/boot/</code> 目录；内核二进制文件会输出到 <code>arch/arm64/boot/dts/hisilicon/hi6220-hikey.dtb</code> 文件。要了解如何将新编译的内核嵌入到 AOSP 映像中，请查看<a href="/setup/build/building-kernels#running">运行内核</a>部分中的说明。</p>

</body></html>
