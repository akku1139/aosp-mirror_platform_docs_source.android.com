<html devsite><head>

  <meta name="book_path" value="/_book.yaml"/>

  <meta name="project_path" value="/_project.yaml"/>
</head>
<body>

<!--
  Copyright 2019 The Android Open Source Project

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<h1 id="5g_non-standalone_nsa" class="page-title">5G 非独立组网 (NSA)</h1>

<p>搭载 Android 10 或更高版本的设备可支持 5G 非独立组网 (NSA)。5G NSA 是一种 5G 网络解决方案，其网络由现有的 4G 基础架构提供支持。Android 10 设备在连接到 5G 网络后，便可以在状态栏上显示 5G 图标。</p>

<h2 id="implementation">实现</h2>

<h3 id="carrier_configuration">运营商配置</h3>

<p>要配置 5G 图标在状态栏上的显示方式，运营商可以使用 <code>CarrierConfig</code> 中的 <a href="https://android.googlesource.com/platform/frameworks/base/+/refs/heads/master/telephony/java/android/telephony/CarrierConfigManager.java#2459" class="external"><code>KEY_5G_ICON_CONFIGURATION_STRING</code></a> 键。</p>

<p>5G NSA 包含四种状态：</p>

<ol>
<li>设备连接到作为辅助移动网络的 5G 移动网络，且使用毫米波。</li>
<li>设备连接到作为辅助移动网络的 5G 移动网络，但不使用毫米波。</li>
<li>设备驻留在具备 5G 能力的网络上（设备不必连接到作为辅助移动网络的 5G 移动网络），并且对 5G 的使用不受限。</li>
<li>设备驻留在具备 5G 能力的网络上（设备不必连接到作为辅助移动网络的 5G 移动网络），但对 5G 的使用受限。</li>
</ol>

<p>配置字符串包含由英文逗号分隔的多个键值对。每个键值对的键和值都由英文冒号分隔。配置字符串中的键对应于上述四种 5G 状态之一，并且必须是下列其中一项：</p>

<ol>
<li><code>connected_mmwave</code></li>
<li><code>connected</code></li>
<li><code>not_restricted</code></li>
<li><code>restricted</code></li>
</ol>

<p>配置字符串中的值必须是与 <code>/packages/SystemUI/res/</code> 目录中的图标名称匹配的有效图标名称。5G NSA 有两个默认图标：<code>5G</code> 和 <code>5G_PLUS</code>。</p>

<p><img src="/devices/tech/connect/images/5g-nsa-icons.png" alt="5G NSA 图标"/></p>

<p><strong>图 1.</strong> 默认的 <code>5G</code> 和 <code>5G_PLUS</code> 5G 图标</p>

<p>以下是 <code>CarrierConfig</code> 中 5G 图标的配置字符串示例。</p>
<pre class="prettyprint"><code>connected_mmwave:5G_PLUS,connected:5G,not_restricted:None,restricted:None
</code></pre>
<h3 id="system_ui">系统界面</h3>

<p>要自定义运营商可用于特定状态的图标，请在 <a href="https://android.googlesource.com/platform/frameworks/base/+/master/packages/SystemUI/src/com/android/systemui/statusbar/policy/TelephonyIcons.java#25" class="external"><code>TelephonyIcons.java</code></a> 中添加 <code>MobileIconGroup</code> 对象。<code>MobileIconGroup</code> 中的图标名称必须与 <code>CarrierConfig</code> 中使用的图标名称一致。以下示例说明了如何将名为“5G_PLUS”的自定义图标添加到 <code>MobileIconGroup</code>。</p>
<pre class="prettyprint"><code>static final MobileIconGroup NR_5G_PLUS = new MobileIconGroup(
            "5G_PLUS",
            null,
            null,
            AccessibilityContentDescriptions.PHONE_SIGNAL_STRENGTH,
            0,
            0,
            0,
            0,

AccessibilityContentDescriptions.PHONE_SIGNAL_STRENGTH[0],
            R.string.data_connection_5g_plus,
            TelephonyIcons.ICON_5G_PLUS,
            true);
</code></pre>
<h2 id="validation">验证</h2>

<p>要验证您的实现，请确保当设备连接到 5G 移动网络时，状态栏上会显示 5G 图标。</p>

</body></html>