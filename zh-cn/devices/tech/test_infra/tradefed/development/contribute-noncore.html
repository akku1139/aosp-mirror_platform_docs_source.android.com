<html devsite><head>

  <meta name="book_path" value="/_book.yaml"/>

  <meta name="project_path" value="/_project.yaml"/>
</head>
<body>
<!--
  Copyright 2019 The Android Open Source Project

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<h1 id="contribute_non-core_code" class="page-title">贡献非核心代码</h1>

<p>为了使向 tradefederation 项目贡献非核心 src 的团队能够完全掌控审核流程，我们创建了以下项目，这些项目向所有团队开放了两项以上的权限。这样会减轻核心 tradefederation 团队的负担，让他们免去与核心框架无关的所有代码审核工作，同时也让其他团队能够在审核周期内更快地迭代。</p>

<p><strong>非核心 src</strong> 是指不是 tradefederation 框架正常运行所必需的代码（例如，自定义测试、配置和特定测试实用程序）。</p>

<blockquote>
<p>重要提示：非核心 src 不得扩展核心 tradefederation 类。<strong><em></em></strong>这样做会影响未来的重构/清理。如果您不确定您的代码是属于核心代码还是 contrib 代码，请与 android-tradefed@ 联系，让他们为您解释清楚。核心 tradefederation 团队很乐意为您提供建议和接收功能请求。</p>

<p>例如，<code>com.google.android.tradefed.build</code> 软件包中的任何类都是核心 tradefederation 类，如：<code>com.google.android.tradefed.build.LaunchControlProvider</code></p>

<p>同样，如果您不清楚哪些类将被视为核心类，请与 android-tradefed@ 联系。</p>
</blockquote>

<p>[TOC]</p>

<h2 id="contrib_projects_paths">contrib 项目的路径</h2>

<ul>
<li><a href="https://android.googlesource.com/platform/tools/tradefederation/contrib/+/refs/heads/master">platform/tools/tradefederation/contrib</a></li>
</ul>

<h2 id="who_are_these_contrib_projects_for">这些 contrib 项目的使用对象是谁？</h2>

<p>如果您目前是编写测试/测试实用程序/配置的 tradefederation 项目组人员，那么这些 contrib 项目就是为您创建的。</p>

<h2 id="code_reviews_in_contrib_projects">contrib 项目中的代码审核</h2>

<p>contrib 项目的目标是允许您在 Tradefed 中进行开发，而无需经过核心团队 (android-tradefed@) 的审核。因此，我们希望您的团队或任何熟悉您所处环境的人对您的 CL 执行代码审核。</p>

<p>如果您遇到难题或在特殊情况下需要指导，请随时与 android-tradefed@ 联系，而不要在默认情况下依赖它来执行 contrib 中的代码审核。<strong>对于 contrib 中的代码审核，Tradefed 团队未设定相应的 SLO。</strong></p>

<h2 id="where_can_i_start_working_on_these_projects">我在哪里可以开始处理这些项目？</h2>

<p>这些项目已添加到以下分支清单，并且已经是主平台签出的一部分，因此如果您没有在自己的环境中看到这些项目，那么说明您的代码库与贡献代码未同步。</p>

<ul>
<li>master</li>
<li>tradefed</li>
<li>oc-dev</li>
<li>oc-dev-plus-aosp</li>
<li>nyc-mr2-dev-plus-aosp</li>
<li>master-daydream-dev</li>
<li>master-without-vendor</li>
<li>wear-master</li>
</ul>

<h2 id="development_and_testing">开发和测试</h2>

<p>在 contrib 中进行开发时，应与 Android 代码库中的其他任何位置达到相同的质量标准：</p>

<ul>
<li>遵循 Android 格式设置准则</li>
<li>代码经过测试并与测试一起提交</li>
<li>设计经过深思熟虑且有意义</li>
</ul>

<h3 id="how_to_test_locally_in_contrib">如何在 contrib 中进行本地测试？</h3>

<h4 id="aosp">AOSP</h4>

<p>在 aosp 中，contrib 的单元测试位于 <a href="https://android.googlesource.com/platform/tools/tradefederation/contrib/+/refs/heads/master/tests/src/com/android">platform/tools/tradefederation/contrib/tests/src/</a>，并且应将单元测试添加到 <a href="https://android.googlesource.com/platform/tools/tradefederation/contrib/+/refs/heads/master/tests/src/com/android/tradefed/prodtests/UnitTests.java">com.android.tradefed.prodtests.UnitTests</a>，才会在提交前测试和本地测试脚本中提取它们。</p>

<p>运行 lunch 命令后的 aosp 本地脚本：</p>
<pre class="prettyprint"><code>tools/tradefederation/core/tests/run_tradefed_aosp_presubmit.sh
</code></pre>
<h2 id="build_rules_update_to_contrib_projects">contrib 项目的编译规则更新</h2>

<p>编译规则 (makefile) 在它们自己的 <code>build/</code> 文件夹下，并且由 <code>OWNERS</code> 文件锁定，该文件将阻止您在未经核心团队额外审核的情况下修改这些规则。这是对 contrib 项目的唯一限制。</p>

<p>我们需要这一审核环节来确保在核心团队不知情或不同意的情况下，不会向整体 Tradefed 项目添加意外的依赖项。如果您确实需要添加一些新的依赖项，请与 <code>android-tradefed@</code> 联系，让他们调查您的用例并给出建议。</p>

</body></html>