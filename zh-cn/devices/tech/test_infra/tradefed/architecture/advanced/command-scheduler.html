<html devsite><head>

  <meta name="book_path" value="/_book.yaml"/>

  <meta name="project_path" value="/_project.yaml"/>
</head>
<body>
<!--
  Copyright 2019 The Android Open Source Project

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<h1 id="test_command_scheduler" class="page-title">测试命令调度程序</h1>

<p>在 Tradefed 中，每个测试请求都要经过<a href="https://android.googlesource.com/platform/tools/tradefederation/+/refs/heads/master/src/com/android/tradefed/command/CommandScheduler.java">命令调度程序</a>才能运行。因此，命令调度程序是运行测试所需的自动化测试框架的关键组件。</p>

<h2 id="life_cycle">生命周期</h2>

<p>将测试请求提交给 Tradefed 时（例如，从控制台输入），该请求会在运行之前依次执行以下事件：</p>

<ol>
<li>解析测试请求 - 测试请求通常由 XML Tradefed 配置引用和后跟的选项组成。<em></em>例如：<code>&gt; run host --class com.android.tradefed.build.BuildInfoTest</code></li>
<li>请求设备管理器查找与测试请求匹配的设备 - 设备管理器将<a href="/devices/tech/test_infra/tradefed/architecture/device-manager/device-allocation">分配与测试请求匹配的设备</a>。<em></em>例如，如果请求 Pixel 设备，则设备管理器将查找可用的 Pixel 设备。</li>
<li>测试请求 + 设备以调用的形式启动 - 开始测试。<em></em></li>
<li>释放设备 - 调用完成后，分配的设备将被释放，并可分配给其他测试。<em></em></li>
</ol>

<h2 id="tradefed_invocation">Tradefed 调用</h2>

<p>Tradefed 中的调用是指当前正在执行测试命令。调用中包含的设备标记为 <code>allocated</code>，其他测试无法使用这些设备来运行。</p>

<p>TF 将按此顺序执行以下步骤：</p>

<ol>
<li><a href="/devices/tech/test_infra/tradefed/architecture/build-provider">编译和测试工件下载</a></li>
<li><a href="/devices/tech/test_infra/tradefed/architecture/target-preparer">目标准备</a></li>
<li><a href="/devices/tech/test_infra/tradefed/architecture/advanced/test-runner">测试执行</a></li>
<li><a href="/devices/tech/test_infra/tradefed/architecture/target-preparer">目标清理</a></li>
<li><a href="/devices/tech/test_infra/tradefed/architecture/result-reporter">结果报告</a></li>
</ol>

<p>在<a href="/devices/tech/test_infra/tradefed/architecture">“架构”部分</a>中，更详细地介绍了各个步骤。</p>

</body></html>