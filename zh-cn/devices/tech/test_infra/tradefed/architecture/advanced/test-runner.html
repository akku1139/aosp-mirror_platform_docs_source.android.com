<html devsite><head>

  <meta name="book_path" value="/_book.yaml"/>

  <meta name="project_path" value="/_project.yaml"/>
</head>
<body>
<!--
  Copyright 2019 The Android Open Source Project

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<h1 id="structure_of_a_test_runner" class="page-title">测试运行程序的结构</h1>

<p>测试运行程序是调用流程的执行单元。这是实际运行测试的地方。</p>

<h2 id="interfaces">接口</h2>

<p>测试运行程序通过 <a href="https://android.googlesource.com/platform/tools/tradefederation/+/refs/heads/master/src/com/android/tradefed/testtype/IRemoteTest.java">IRemoteTest 接口</a>进行定义，该接口提供了一种简单的 <code>run</code> 实现方法，在要运行测试时将调用该方法。</p>

<p>这样可以对测试运行进行最简单的定义。但在实际操作中，测试编写者需要更多信息才能正确编写测试，通常是版本和设备信息。在这种情况下以下接口便派上用场。</p>

<h3 id="basic">基本</h3>

<p>下面两个是目前使用最广泛的接口，因为它们可满足大多数测试的基本需求。</p>

<ul>
<li><a href="https://android.googlesource.com/platform/tools/tradefederation/+/refs/heads/master/src/com/android/tradefed/testtype/IBuildReceiver.java">IBuildReceiver</a>
允许测试获取在<a href="/devices/tech/test_infra/tradefed/architecture/build_provider">版本提供程序</a>步骤中创建的 <code>IBuildInfo</code> 对象，该对象包含与测试设置相关的所有信息和工件。</li>
<li><a href="https://android.googlesource.com/platform/tools/tradefederation/+/refs/heads/master/src/com/android/tradefed/testtype/IDeviceTest.java">IDeviceTest</a>
允许 TF 接收代表被测设备的 <code>ITestDevice</code> 对象，并提供用来与之交互的 API。</li>
</ul>

<h3 id="advanced">高级</h3>

<p>还有一些其他接口，允许在自动化测试框架与测试运行程序之间进行更复杂的交互：</p>

<ul>
<li><a href="https://android.googlesource.com/platform/tools/tradefederation/+/refs/heads/master/src/com/android/tradefed/testtype/ITestFilterReceiver.java">ITestFilterReceiver</a>
允许测试接收一组过滤器，以便仅运行某些测试。这在运行测试的子集时很有用。</li>
<li><a href="https://android.googlesource.com/platform/tools/tradefederation/+/refs/heads/master/src/com/android/tradefed/testtype/ITestCollector.java">ITestCollector</a>
允许测试运行程序仅模拟运行测试，而不是实际执行测试。这在收集所有测试用例的列表时很有用。</li>
</ul>

<h2 id="existing_test_runners">现有测试运行程序</h2>

<p>已经存在各种测试运行程序，一些用于主要测试类型：</p>

<ul>
<li><a href="/reference/tradefed/com/android/tradefed/testtype/AndroidJUnitTest">AndroidJUnitTest/InstrumentationTest</a>（与设备端的 AJUR 关联）</li>
<li>使用 <a href="https://github.com/google/googletest">googletest 库</a>的 <a href="/reference/tradefed/com/android/tradefed/testtype/GTest">GTest</a>（设备端和主机端）</li>
<li><a href="/reference/tradefed/com/android/tradefed/testtype/HostTest">主机驱动的测试</a>（在主机上执行并从主机调用设备的 Java 测试）</li>
<li><a href="/reference/tradefed/com/android/tradefed/testtype/HostTest">纯 Java 单元测试</a>（我们的运行程序能够运行这两种测试）</li>
<li><a href="/reference/tradefed/com/android/tradefed/testtype/python/PythonBinaryHostTest">Python 测试</a></li>
<li>使用<a href="https://github.com/google/benchmark">基准库</a>的 <a href="/reference/tradefed/com/android/tradefed/testtype/GoogleBenchmarkTest">Google 基准测试</a></li>
</ul>

<p>除上述这些之外，还存在大量的自定义测试运行程序。它们在一些功能测试（例如启动测试）中发挥专门的用途。</p>

<h2 id="writing_new_a_test_runner">编写新的测试运行程序</h2>

<p>如需关于编写新测试运行程序的更多指导，请参阅<a href="/devices/tech/test_infra/tradefed/testing/through-tf/new-test-runner">编写测试部分</a>。</p>

</body></html>