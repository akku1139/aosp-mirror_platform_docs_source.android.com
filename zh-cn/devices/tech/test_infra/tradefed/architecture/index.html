<html devsite><head>

  <meta name="book_path" value="/_book.yaml"/>

  <meta name="project_path" value="/_project.yaml"/>
</head>
<body>
<!--
  Copyright 2019 The Android Open Source Project

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<h1 id="overview_of_trade_federation_architecture" class="page-title">Trade Federation 架构概览</h1>

<p>本部分介绍 Tradefed 的内部构件以及这些构件的关系。如需了解详情，请参阅链接的子页面。</p>

<h2 id="1_test_configuration_xml_configs">1. 测试配置（XML 配置）</h2>

<h3 id="overview">概览</h3>

<p>Tradefed 中的测试配置采用 XML 格式进行描述。了解配置的结构是运行和自定义测试的关键。</p>

<h3 id="structure_of_tf_configurations">TF 配置的结构</h3>

<ul>
<li><a href="/devices/tech/test_infra/tradefed/architecture/xml-config">高级结构</a></li>
<li><a href="/devices/tech/test_infra/tradefed/architecture/xml-config/template-include">模板和包含</a></li>
<li><a href="/devices/tech/test_infra/tradefed/architecture/xml-config/config-object">配置对象</a></li>
</ul>

<h3 id="global_tf_configurations">全局 TF 配置</h3>

<p>全局配置是一种特殊的 Tradefed XML 配置，在 Tradefed 通过 <code>TF_GLOBAL_CONFIG</code> 环境变量启动时加载。它会加载与 Tradefed 实例范围相关的对象，这些对象将影响自动化测试框架的整体行为。</p>

<p><a href="/devices/tech/test_infra/tradefed/architecture/advanced/global-config">全局配置详情</a></p>

<h3 id="keystore">密钥库</h3>

<p>密钥库允许将来自某个密钥库的命令行选项注入 Tradefed，以避免直接在命令行上引用相应值。这可用于在命令行中隐藏密码，方法是直接从密钥库检索密码。</p>

<p><a href="/devices/tech/test_infra/tradefed/architecture/advanced/keystore">密钥库详情</a></p>

<h2 id="2_device_manager">2. 设备管理器</h2>

<p>设备管理器负责跟踪正在运行的 Tradefed 实例上的设备状态。它会监控分配状态和在线状态等方面。</p>

<ul>
<li><a href="/devices/tech/test_infra/tradefed/architecture/device-manager">设备状态</a></li>
<li><a href="/devices/tech/test_infra/tradefed/architecture/device-manager/device-allocation">设备分配</a></li>
<li><a href="/devices/tech/test_infra/tradefed/architecture/device-manager/device-detection">设备检测序列</a></li>
</ul>

<h2 id="3_test_command_scheduler">3. 测试命令调度程序</h2>

<p>Tradefed 中的测试命令调度程序接受要运行的命令、将这些命令与设备关联，并启动测试调用。</p>

<ul>
<li><a href="/devices/tech/test_infra/tradefed/architecture/advanced/command-scheduler">测试命令生命周期</a></li>
</ul>

<h2 id="4_build_provider">4. 版本提供程序</h2>

<p>任何测试调用的第一步都是调用版本提供程序。它会下载设置和运行测试所需的资源（版本映像、测试 APK 等等）。它还会在将传递给测试的 <code>BuildInfo</code> 对象中引用这些资源。本地可用的资源也可以链接在 <code>BuildInfo</code> 对象中。</p>

<ul>
<li><a href="/devices/tech/test_infra/tradefed/architecture/build-provider">版本提供程序详情</a></li>
<li><a href="/devices/tech/test_infra/tradefed/architecture/build-provider/build-info">版本信息详情</a></li>
</ul>

<h2 id="5_target_preparer_and_cleaner">5. 目标准备器和清理器</h2>

<p>目标准备器提供了一些可选操作，用于将被测目标配置为某种状态，例如刷写设备、设置某些属性以及连接到 Wi-Fi。</p>

<ul>
<li><a href="/devices/tech/test_infra/tradefed/architecture/target-preparer">添加新的目标准备器/清理器</a></li>
<li><a href="/devices/tech/test_infra/tradefed/architecture/target-preparer/multi-target">添加新的多目标准备器</a></li>
</ul>

<h2 id="6_test_runner">6. 测试运行程序</h2>

<p>Tradefed 中的测试运行程序是指负责实际测试执行的对象。不同的测试运行程序以不同的方式驱动测试执行；例如，插桩测试运行程序将与 JUnit 测试运行程序截然不同。</p>

<ul>
<li><a href="/devices/tech/test_infra/tradefed/architecture/advanced/test-runner">测试运行程序结构</a></li>
</ul>

<h2 id="7_result_reporter">7. 结果报告程序</h2>

<p>Tradefed 中的结果报告程序是指会将结果发送到特定目的地的对象。每个实现通常专用于不同的结果后端。结果报告程序负责将 Tradefed 结果格式转换为目标格式。</p>

<p>借助这种灵活的设计，任何测试都能向任何结果目标报告结果，而且还能以隔离的方式轻松添加更多测试。</p>

<ul>
<li><a href="/devices/tech/test_infra/tradefed/architecture/result-reporter">添加结果报告程序</a></li>
<li><a href="/devices/tech/test_infra/tradefed/architecture/result-reporter/log-reporter">结果报告程序和日志</a></li>
<li><a href="/devices/tech/test_infra/tradefed/architecture/result-reporter/summary">结果报告程序摘要</a></li>
</ul>

<h2 id="8_metrics_collector">8. 指标收集器</h2>

<p>指标收集器是 Tradefed 中的一个特殊对象，与测试执行正交。它允许在测试生命周期的不同时间点（例如，测试开始时间和测试结束时间）收集信息。由于收集器独立于测试本身，因此可以交换、添加和移除这些时间点，而不必更改测试本身。</p>

<ul>
<li><a href="/devices/tech/test_infra/tradefed/architecture/metrics-collector">主机驱动的指标收集器</a></li>
<li><a href="/devices/tech/test_infra/tradefed/architecture/metrics-collector/device-collector">设备端指标收集器</a></li>
</ul>

<h2 id="9_host-wide_setup">9. 主机范围的设置</h2>

<p>本部分介绍适用于完整 Tradefed 实例运行的设置。这些选项会影响整个自动化测试框架的行为，以便适应不同的环境，例如在受限网络中。</p>

<ul>
<li><a href="/devices/tech/test_infra/tradefed/architecture/advanced/global-config">全局配置</a></li>
<li><a href="/devices/tech/test_infra/tradefed/architecture/host-setup/host-options">主机选项</a></li>
</ul>

<hr />

<h2 id="10_additional_features">10. 其他功能</h2>

<p>下面几部分介绍 Tradefed 而非 Tradefed 对象的一般用法。</p>

<h3 id="tradefed_sharding">Tradefed 分片</h3>

<p>如果测试语料库很大或执行需要很长时间，可以将其拆分到多部设备上。我们将这种拆分称为“分片”。<em></em>本部分介绍分片的工作原理及其配置方式。</p>

<p><a href="/devices/tech/test_infra/tradefed/architecture/advanced/sharding">分片详情</a></p>

<h3 id="using_sl4a">使用 SL4A</h3>

<p>Tradefed 支持 Android 的脚本层，即 SL4A；这是一个自动化工具集，用于以独立于平台的方式调用 Android API。</p>

<p><a href="/devices/tech/test_infra/tradefed/architecture/advanced/scripting-sl4a">SL4A 与 Tradefed 配合使用详情</a></p>

<h3 id="dynamic_option_download">动态 @Option 下载</h3>

<p>在某些情况下，测试或某项特定操作所需的文件不在本地。此功能允许 Tradefed 从远程位置获取这些文件，而无需通过版本提供程序。</p>

<p><a href="/devices/tech/test_infra/tradefed/architecture/advanced/protocols-global-config">动态 @option 下载</a></p>

</body></html>