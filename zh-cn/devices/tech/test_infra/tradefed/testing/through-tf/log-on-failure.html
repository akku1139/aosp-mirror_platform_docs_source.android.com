<html devsite><head>

  <meta name="book_path" value="/_book.yaml"/>

  <meta name="project_path" value="/_project.yaml"/>
</head>
<body>
<!--
  Copyright 2019 The Android Open Source Project

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<h1 id="automated_log_on_failure_collection" class="page-title">自动收集有关失败的日志</h1>

<p>调试测试时，始终需要一组日志，以便大致了解失败和被测设备的情况。日志来源包括：Logcat、Tradefed 主机日志、屏幕截图等。</p>

<p>为了让这些日志通用并让所有测试编写人员都可以轻松获取，Tradefed 内置了一种机制来帮助收集。</p>

<h2 id="configuration">配置</h2>

<p>要自动收集有关失败的部分日志，您可以将以下选项添加到 Tradefed 命令行中：</p>
<pre class="prettyprint lang-shell"><code>--auto-collect LOGCAT_ON_FAILURE
or
--auto-collect SCREENSHOT_ON_FAILURE
</code></pre>
<p>要查看可能值的完整列表，请参阅 <a href="https://android.googlesource.com/platform/tools/tradefederation/+/master/src/com/android/tradefed/device/metric/AutoLogCollector.java">AutoLogCollector</a></p>

<p>为方便起见，logcat 和屏幕截图各有一个直观的标记：</p>
<pre class="prettyprint lang-shell"><code>--logcat-on-failure
and
--screenshot-on-failure
</code></pre>
<h2 id="note_on_suite_modules_androidtestxml">有关套件模块的说明 (AndroidTest.xml)</h2>

<p>模块不能在 <code>AndroidTest.xml</code> 中直接指定此选项，但它们可以改为使用<a href="/devices/tech/test_infra/tradefed/testing/through-suite/module-controller">模块控制器</a>。</p>

</body></html>