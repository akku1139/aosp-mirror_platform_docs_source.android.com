<html devsite><head>
    <title>支持多窗口模式</title>
    <meta name="project_path" value="/_project.yaml"/>
    <meta name="book_path" value="/_book.yaml"/>
  </head>
  <body>

  <!--
      Copyright 2017 The Android Open Source Project

      Licensed under the Apache License, Version 2.0 (the "License");
      you may not use this file except in compliance with the License.
      You may obtain a copy of the License at

          http://www.apache.org/licenses/LICENSE-2.0

      Unless required by applicable law or agreed to in writing, software
      distributed under the License is distributed on an "AS IS" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
      See the License for the specific language governing permissions and
      limitations under the License.
  -->
    <p>在 Android 7.0 及更高版本中，设备可以使用多窗口模式同时显示多个应用。Android 支持三种多窗口模式配置：</p>
    <ul>
      <li>
        <strong>分屏</strong>是默认的多窗口模式实现，可为用户提供两个 Activity 窗格来放置应用。
      </li>
      <li>
        <strong>自由窗口</strong>允许用户动态调整 Activity 窗格大小，并在屏幕上显示两个以上的应用。
      </li>
      <li>
        <strong>画中画 (PIP)</strong> 允许 Android 设备在用户与其他应用互动时在小窗口中播放视频内容。
      </li>
    </ul>

    <h2 id="implementation">实现</h2>
    <p>Android 7.0 及更高版本中会默认启用多窗口模式支持。要停用该功能，请在设备的 <a href="https://android.googlesource.com/platform/frameworks/base/+/master/core/res/res/values/config.xml" class="external">config.xml</a> 文件中将 <code>config_supportsMultiWindow</code> 标记设为 <code>false</code>。
    </p>
    <p>所有低内存设备（声明 <code>ActivityManager.isLowRam()</code> 的设备）默认停用多窗口模式。低内存设备会忽略 <code>config_supportsMultiWindow</code> 标记的值。
    </p>

    <h3 id="split-screen">分屏</h3>
    <p>多窗口模式的默认体验是分屏模式，在这种模式下，系统会从设备中间以横向或纵向方式划分系统界面。用户可以根据设备的屏幕方向左右或上下拖动分界线来调整窗口大小。
    </p>
    <p>启用分屏后，设备制造商可以选择要启用自由窗口还是“画中画”模式。</p>
    <p>在 Android 8.0 及更高版本中，在用户点按<strong>主屏幕</strong>时，系统会压缩启动器的大小以改进分屏效果。如需实现方面的详细信息，请参阅<a href="/devices/tech/display/split-screen">分屏交互</a>。
    </p>

    <h3 id="freeform">自由窗口</h3>
    <p>通过 <code>config_supportsMultiWindow</code> 标记启用多窗口模式后，设备制造商可以允许启用自由窗口。此模式在较大的设备（例如平板电脑）上最为有用。
    </p>
    <p>要支持自由窗口模式，请在 <code><a href="https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/content/pm/PackageManager.java" class="external">/android/frameworks/base/core/java/android/content/pm/PackageManager.java</a></code> 中启用 <code>PackageManager#FEATURE_FREEFORM_WINDOW_MANAGEMENT</code> 系统功能，并在 <code><a href="https://android.googlesource.com/platform/frameworks/base/+/master/core/res/res/values/config.xml" class="external">config.xml</a>.</code> 中将 <code>config_freeformWindowManagement</code> 设为 <code>true</code>。
    </p>
    <pre class="devsite-click-to-copy">
    &lt;bool name="config_freeformWindowManagement"&gt;true&lt;/bool&gt;
    </pre>

    <h3 id="picture-in-picture">画中画</h3>
    <p>通过 <code>config_supportsMultiWindow</code> 标记启用多窗口模式后，设备制造商可以支持<a href="https://developer.android.com/training/tv/playback/picture-in-picture.html" class="external">画中画</a>功能，以便允许用户在浏览其他 Activity 的同时观看视频。虽然此功能针对的是 Android 电视设备，但其他设备类型也可以支持此功能。
    </p>
    <p>要支持画中画功能，请在 <code><a href="https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/content/pm/PackageManager.java" class="external">/android/frameworks/base/core/java/android/content/pm/PackageManager.java</a></code> 中启用 <code>PackageManager#FEATURE_PICTURE_IN_PICTURE</code> 系统功能。
    </p>
    <p>要了解搭载 Android 8.0 及更高版本的设备的画中画实现详情，请参阅<a href="/devices/tech/display/pip">画中画</a>页面。
    </p>

    <h3 id="system-ui">系统界面</h3>
    <p>如<a href="https://developer.android.com/guide/topics/ui/multi-window.html#testing" class="external">多窗口模式开发者文档</a>中所述，该功能支持所有标准系统界面。
    </p>

    <h3 id="apps">应用</h3>
    <p>要在预加载应用中提供多窗口模式支持，请参阅 <a href="https://developer.android.com/guide/topics/ui/multi-window.html" class="external">Android 开发者文档</a>。
    </p>

    <h2 id="validation">验证</h2>
    <p>要验证多窗口模式的实现情况，请运行相关 CTS 测试，并按照<a href="https://developer.android.com/guide/topics/ui/multi-window.html#testing" class="external">多窗口模式测试说明</a>进行操作。
    </p>
    <p>对于 Android 7.0，相关测试位于 <code><a href="https://android.googlesource.com/platform/cts/+/refs/heads/nougat-cts-release/hostsidetests/services/activitymanager/src/android/server/cts" class="eternal">/platform/cts/hostsidetests/services/activitymanager/src/android/server/cts</a></code>。在 Android 8.0 及更高版本中，相关测试位于 <code><a href="https://android.googlesource.com/platform/cts/+/refs/heads/master/tests/framework/base/activitymanager/src/android/server/am" class="external">/platform/cts/tests/framework/base/activitymanager/src/android/server/am</a></code>。
    </p>

</body></html>