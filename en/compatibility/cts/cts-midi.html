<html devsite>
<head>
  <title>CTS Verifier MIDI Tests</title>
  <meta name="project_path" value="/_project.yaml" />
  <meta name="book_path" value="/_book.yaml" />
</head>

<body>
  <!--
      Copyright 2019 The Android Open Source Project

      Licensed under the Apache License, Version 2.0 (the "License");
      you may not use this file except in compliance with the License.
      You may obtain a copy of the License at

          http://www.apache.org/licenses/LICENSE-2.0

      Unless required by applicable law or agreed to in writing, software
      distributed under the License is distributed on an "AS IS" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
      See the License for the specific language governing permissions and
      limitations under the License.
  -->
  {% include "_versions.html" %}


<p>
While most CTS test activities automatically occur
when the test begins, testing MIDI functionality in Android {{ androidQVersionNumber }}
CTS Verifier requires human intervention
to connect appropriate peripherals to the device under test.
</p>

<h3 id="assembling-required-peripherals">Assembling required peripherals</h3>
<p>
The CTS Verifier MIDI test tests MIDI functionality with USB MIDI interfaces,
Bluetooth MIDI interfaces, and a virtual MIDI device path. Further, for the
Bluetooth interface portion of the test, the USB MIDI interface is used to implement
a loopback from the Bluetooth interface output back to its input. Thus,
the CTS Verifier MIDI requires a USB MIDI interface device and a
<a href="/compatibility/cts/usb-audio#recommended-peripherals"
class="external">mandated peripheral</a> device.
</p>

<p>
An acceptable USB MIDI peripheral can be any that is recognized by the device under
test and has standard, round 5-pin DIN MIDI female jacks. Some USB MIDI
interfaces are designed to be connected directly to a MIDI instrument with the use of a MIDI
cable. These devices have a pair of male plugs and so can't be looped back with a
standard MIDI cable.
</p>

<p>The recommended peripherals are:</p>
<ul>
<li><a href="https://usa.yamaha.com/products/music_production/accessories/md-bt01/index.html#product-tabs"
class="external">Yamaha Wireless MD-BT01 5-PIN DIN MIDI Adapter</a></li>
<li><a href="http://quicco.co.jp/products/"
class="external">Wireless MIDI Interface mi.1 [Rev.3]</a></li>
<li>A bluetooth MIDI peripheral that meets <a href="https://www.midi.org/specifications-old/item/bluetooth-le-midi"
class="external">MIDI specs</a></li>
</ul>

<aside class="note"><strong>Note:</strong> All of the
<a href="/compatibility/cts/usb-audio#usb-audio-interface"
class="external">mandated USB audio interface peripherals</a> meet the requirements of this test.</aside>
<p>
  <img src="/compatibility/cts/images/CTS-Verifier0.png" alt="USB with MIDI front" width ="300" id="gdcalert1"/>
  <p class="img-caption">
    <strong>Figure 1.</strong> A typical USB audio interface with MIDI (front view)
</p>

<p>
  <img src="/compatibility/cts/images/CTS-Verifier1.png" alt="USB with MIDI rear" width ="300" id="gdcalert2"/>
  <p class="img-caption">
    <strong>Figure 2.</strong> A typical USB audio interface with MIDI (rear view)
    with MIDI I/O female jacks
</p>

<p>
  <img src="/compatibility/cts/images/CTS-Verifier2.png" alt="MIDI with I/O male" width ="300" id="gdcalert2"/>
  <p class="img-caption">
    <strong>Figure 3.</strong> A Bluetooth MIDI adapter with MIDI I/O male plugs
</p>


<h3 id="loopback-tests">Loopback tests</h3>
<p>
All of the loopback tests send a set of MIDI messages out through the test peripheral,
loop back that data, and then monitor the input of that device to ensure that the
data received matches the data that was sent.
</p>

<h3 id="usb-midi-loopback-test">USB MIDI loopback test</h3>
<p>
This tests the MIDI functionality through a USB MIDI interface. The loopback mechanism
in this case is a standard MIDI cable connected to both the input and output jacks on
the interface.
</p>

<p>
  <img src="/compatibility/cts/images/CTS-Verifier3.png" alt="standard MIDI" width ="300" id="gdcalert3"/>
  <p class="img-caption">
    <strong>Figure 4.</strong> A standard MIDI cable
</p>

<p>
  <img src="/compatibility/cts/images/CTS-Verifier4.png" alt="MIDI to USB MIDI" width ="300" id="gdcalert4"/>
  <p class="img-caption">
    <strong>Figure 5.</strong> The MIDI cable connected to USB MIDI interface
</p>

<p>
When the USB MIDI interface is connected to the device under test, the <strong>USB Input</strong>
and <strong>USB Output</strong> labels display the name of the interface and the <strong>Test USB MIDI
Interface</strong> button is enabled.
</p>

<p>
Tap <strong>Test USB MIDI Interface</strong> and the <strong>Status</strong> label
displays the results of the test.
</p>

<p>
  <img src="/compatibility/cts/images/CTS-Verifier5.png" alt="USB MIDI loopback" width ="300" id="gdcalert5"/>
  <p class="img-caption">
    <strong>Figure 6.</strong> USB MIDI loopback test ready to run
</p>

<aside class="note"><strong>Note:</strong> If the test fails with a description of
<strong>Timeout @0</strong>, the loopback MIDI cable is probably disconnected or incorrectly connected.</aside>

<p> If the test fails with <strong>Timeout @<some other value></strong>, it indicates that not all of
the sent data was received.</p>

<h3 id="virtual-midi-loopback-test">Virtual MIDI loopback test</h3>

<p>
The virtual MIDI loopback test tests the Virtual MIDI Device API.
The test implements a simple virtual MIDI device, which simply loops back its
input to its output. Because this software module is entirely contained in the test
code itself, this test requires no additional hardware and is always enabled.
</p>

<h3 id="bluetooth-midi-loopback-test">Bluetooth MIDI loopback test</h3>
<p>
This tests the MIDI functionality through a Bluetooth MIDI interface. The loopback mechanism
in this case is the USB MIDI interface.
</p>

<p>
Before running the Bluetooth MIDI loopback test, you must connect to the Bluetooth MIDI
adapter with the MIDI BLE Connect app, available for
free in the Play Store.
</p>

<ol>
<li>Connect the Bluetooth MIDI interface to the USB MIDI interface, being careful to
connect the <em>output plug</em> of the Bluetooth MIDI interface to the <em>input jack</em>
of the USB MIDI interface and <em>input plug</em> of the Bluetooth MIDI interface to
the <em>output jack</em> of the USB MIDI interface.</li>

<p>
  <img src="/compatibility/cts/images/CTS-Verifier6.png" alt="Bluetooth MIDI connected" width ="300" id="gdcalert6"/>
  <p class="img-caption">
    <strong>Figure 7.</strong> The Bluetooth MIDI interface properly connected to
    the USB MIDI interface
</p>

<li>Connect the Bluetooth MIDI adapter with the MIDI + BLTE app.</li>

<p>
  <img src="/compatibility/cts/images/CTS-Verifier7.png" alt="MIDI+BLTE" width ="300" id="gdcalert7"/>
  <p class="img-caption">
    <strong>Figure 8.</strong> The MIDI + BLTE main screen
</p>

<li>
Invoke the MIDI + BLTE app and tap <strong>Bluetooth Scan</strong>.
</li>

<p>
  <img src="/compatibility/cts/images/CTS-Verifier8.png" alt="Bluetooth scan" width ="300" id="gdcalert8"/>
  <p class="img-caption">
    <strong>Figure 9.</strong> Bluetooth scan
</p>

<li>
When the Bluetooth interface is recognized, tap the name of the Bluetooth interface. The Bluetooth
interface is now connected and available to the device under test.
</li>

<li>
Switch back to the CTS-Verifier app/MIDI Test.
</li>

<p>
  <img src="/compatibility/cts/images/CTS-Verifier9.png" alt="MIDI test" width ="300" id="gdcalert9"/>
  <p class="img-caption">
    <strong>Figure 10.</strong> MIDI test
</p>
</ol>

<p>
The name of the Bluetooth interface displays and <strong>Test Bluetooth MIDI
Interface</strong> is enabled. Tap <strong>Test Bluetooth MIDI Interface</strong>
and the <strong>Status</strong> label displays the results of the test.</p>

<aside class="note"><strong>Note:</strong> If the test fails with a description of
<strong>Timeout @0</strong>, there might be a problem with the physical connection
of the Bluetooth MIDI interface.</aside>
<p>

<p>
If the test fails with <strong>Timeout @ non-zero value </strong>, it indicates that not all
of the sent data was received.
</p>

<p>
When all three loopback tests have succeeded, tap <img src="/compatibility/cts/images/CTS-Verifier10.png"
width="" alt="alt_text" title="image_tooltip"><strong> </strong>to indicate compliance.
</p>
</body>
</html>
